<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ²‰æµ¸å¼æ•°å­—äºº + å®¢æˆ·æŒ‚è½½</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700;900&display=swap');

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #F9FAFB;
            overflow: hidden;
            /* ç¦æ­¢æ•´ä½“æ»šåŠ¨ */
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        /* =========================================
           1. æ•°å­—äººèˆå° (Avatar Stage)
           åˆå§‹é«˜åº¦ 50vh (ç•™å‡ºç©ºé—´ç»™å®¢æˆ·å¡ç‰‡)
           æ¿€æ´»åå˜ä¸º 200px (ä¿ç•™å¤´éƒ¨ + å®¢æˆ·å¡ç‰‡ç©ºé—´)
           ========================================= */
        #avatar-stage {
            height: 50vh;
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            background: radial-gradient(circle at center, #374151 0%, #111827 100%);
            position: relative;
            z-index: 0;
            padding-top: 60px;
            /* ç»™é¡¶éƒ¨ Header ç•™ç©º */
        }

        /* æ¿€æ´»çŠ¶æ€ï¼šå˜çŸ®ï¼Œä½†æ¯”ä¹‹å‰é«˜ä¸€ç‚¹ï¼Œä¸ºäº†å®¹çº³å®¢æˆ·å¡ç‰‡ */
        #avatar-stage.minimized {
            height: 210px;
        }

        /* å¤´åƒå›¾ç‰‡åŠ¨ç”» */
        #avatar-img {
            transition: all 0.6s ease;
            transform-origin: bottom center;
        }

        /* æ¿€æ´»çŠ¶æ€ï¼šå¤´åƒå¤§å¹…ç¼©å°å¹¶ä¸‹æ²‰ï¼Œç»™ä¸Šé¢çš„å¡ç‰‡è…¾åœ°æ–¹ */
        #avatar-stage.minimized #avatar-img {
            transform: scale(0.6) translateY(20px);
            opacity: 0.8;
        }

        /* =========================================
           2. èŠå¤©é¢æ¿ (Chat Sheet) - å¸·å¹•
           ========================================= */
        #chat-sheet {
            position: absolute;
            top: 48vh;
            /* åˆå§‹ä½ç½® */
            left: 0;
            width: 100%;
            height: 100vh;
            background: #FFFFFF;
            border-radius: 32px 32px 0 0;
            box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.15);
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 10;
            display: flex;
            flex-direction: column;
        }

        /* æ¿€æ´»çŠ¶æ€ï¼šé¢æ¿ä¸Šæ»‘ */
        #chat-sheet.expanded {
            top: 200px;
            /* ç´§è´´åœ¨ minimized stage ä¸‹æ–¹ */
            border-radius: 24px 24px 0 0;
        }

        /* =========================================
           3. å®¢æˆ·æŒ‚è½½å¡ç‰‡ (Context Card) - æ ¸å¿ƒæ–°å¢
           æ‚¬æµ®åœ¨èˆå°ä¹‹ä¸Šï¼Œé‡‡ç”¨ç»ç’ƒæ‹Ÿæ€
           ========================================= */
        .context-card-glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        /* ç©ºæ€æ ·å¼ */
        .context-card-empty {
            background: rgba(255, 255, 255, 0.05);
            border: 1px dashed rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(4px);
        }

        /* å³ä¾§æŠ½å±‰åŠ¨ç”» */
        .drawer-right {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(100%);
        }

        .drawer-open {
            transform: translateX(0);
        }

        /* å†…å®¹åˆ‡æ¢åŠ¨ç”» */
        .fade-enter {
            animation: fadeIn 0.5s forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .bubble-user {
            background: #1F2937;
            color: white;
            border-radius: 20px 4px 20px 20px;
        }

        .bubble-ai {
            background: #F3F4F6;
            color: #1F2937;
            border-radius: 4px 20px 20px 20px;
        }
    </style>
</head>

<body class="h-screen w-full relative overflow-hidden">

    <div id="avatar-stage" class="w-full flex justify-center items-end overflow-hidden">

        <div class="absolute top-0 left-0 w-full p-4 flex justify-between items-center z-30 text-white/80">
            <button class="w-8 h-8 rounded-full bg-black/20 backdrop-blur flex items-center justify-center"><i
                    class="fa-solid fa-chevron-down"></i></button>
            <div
                class="flex items-center gap-2 bg-black/20 backdrop-blur px-3 py-1 rounded-full border border-white/10">
                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                <span class="text-xs font-bold">å¼ ä¼Ÿ AI Â· åœ¨çº¿</span>
            </div>
            <button class="w-8 h-8 rounded-full bg-black/20 backdrop-blur flex items-center justify-center"><i
                    class="fa-solid fa-ellipsis"></i></button>
        </div>

        <div class="absolute top-16 left-0 w-full px-4 z-30">

            <div id="customer-empty"
                class="context-card-empty w-full h-14 rounded-2xl flex items-center justify-center gap-2 cursor-pointer text-white/60 hover:bg-white/10 transition-colors"
                onclick="mountCustomer()">
                <div class="w-6 h-6 rounded-full border border-white/30 flex items-center justify-center text-xs">
                    <i class="fa-solid fa-plus"></i>
                </div>
                <span class="text-xs font-medium">æŒ‚è½½å®¢æˆ·æ¡£æ¡ˆä»¥å¼€å§‹</span>
            </div>

            <div id="customer-active"
                class="context-card-glass w-full h-16 rounded-2xl flex items-center justify-between px-3 pl-4 cursor-pointer hidden"
                onclick="toggleDrawer()">
                <div class="flex items-center gap-3">
                    <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-br from-orange-400 to-orange-600 text-white flex items-center justify-center text-base font-bold shadow-lg border border-white/20">
                        ç‹
                    </div>
                    <div class="flex flex-col text-white">
                        <div class="flex items-center gap-2">
                            <span class="text-sm font-bold">ç‹å¿—è¿œ</span>
                            <span
                                class="px-1.5 py-0.5 bg-white/20 text-white text-[9px] font-bold rounded backdrop-blur-md">HOT</span>
                        </div>
                        <div class="flex items-center gap-2 text-[10px] text-white/70">
                            <span>CTO</span>
                            <span class="w-0.5 h-2 bg-white/30"></span>
                            <span>é¢„ç®—8W</span>
                        </div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center text-white/70">
                    <i class="fa-solid fa-address-card text-xs"></i>
                </div>
            </div>
        </div>

        <img id="avatar-img" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Zhang&style=circle"
            class="w-56 h-56 rounded-full border-4 border-white/10 shadow-2xl mb-4 z-10">

        <div class="absolute bottom-0 w-full h-24 bg-gradient-to-t from-[#111827] to-transparent z-0"></div>
    </div>

    <div id="chat-sheet" class="pb-24">

        <div class="w-full flex justify-center pt-3 pb-1 shrink-0">
            <div class="w-10 h-1 bg-gray-200 rounded-full"></div>
        </div>

        <div id="view-welcome" class="px-6 flex flex-col h-full transition-all duration-500 overflow-hidden">
            <div class="mb-4 mt-2">
                <h1 class="text-xl font-bold text-gray-900 mb-1">æˆ‘æ˜¯å¼ ä¼Ÿ ğŸ‘‹</h1>
                <p class="text-sm text-gray-500">å·²ä¸ºæ‚¨å‡†å¤‡å¥½ <span class="font-bold text-orange-500">ç‹å¿—è¿œ</span> çš„æ¡£æ¡ˆåˆ†æã€‚</p>
            </div>

            <p class="text-xs text-gray-400 font-bold uppercase tracking-wider mb-3">é’ˆå¯¹è¯¥å®¢æˆ·çš„ç­–ç•¥å»ºè®®ï¼š</p>

            <div class="space-y-3 overflow-y-auto no-scrollbar pb-10">
                <button onclick="startChat('ç”Ÿæˆé™ç»´æ‰“å‡»æ–¹æ¡ˆ')"
                    class="w-full bg-gray-50 p-4 rounded-xl border border-gray-100 flex items-center justify-between group hover:bg-orange-50 hover:border-orange-200 transition-colors text-left">
                    <div>
                        <div class="text-sm font-bold text-gray-800"><i
                                class="fa-solid fa-wand-magic-sparkles text-orange-500 mr-2"></i>ç”Ÿæˆé™ç»´æ‰“å‡»æ–¹æ¡ˆ</div>
                        <div class="text-xs text-gray-400 mt-0.5">"é’ˆå¯¹ä»·æ ¼æ•æ„Ÿï¼Œå…ˆåšå®šæœŸé‡ç–¾+åŒ»ç–—..."</div>
                    </div>
                </button>

                <button onclick="startChat('æ¨¡æ‹Ÿå¼‚è®®å¤„ç†')"
                    class="w-full bg-gray-50 p-4 rounded-xl border border-gray-100 flex items-center justify-between group hover:bg-orange-50 hover:border-orange-200 transition-colors text-left">
                    <div>
                        <div class="text-sm font-bold text-gray-800"><i
                                class="fa-solid fa-microphone-lines text-blue-500 mr-2"></i>æ¨¡æ‹Ÿå¼‚è®®å¤„ç†</div>
                        <div class="text-xs text-gray-400 mt-0.5">"æ¼”ç»ƒå¦‚ä½•å›åº”ä»–å¯¹æŸ¥èµ„äº§çš„æŠ—æ‹’..."</div>
                    </div>
                </button>
            </div>
        </div>

        <div id="view-chat" class="px-4 flex-1 overflow-y-auto hidden pt-2 space-y-4">
            <div id="msg-container" class="space-y-4 pb-4"></div>
        </div>
    </div>

    <div class="fixed bottom-0 w-full bg-white border-t border-gray-100 px-4 py-3 pb-6 z-50 flex items-center gap-3">
        <button class="w-10 h-10 rounded-full bg-gray-50 text-gray-500 hover:text-orange-500">
            <i class="fa-solid fa-microphone text-lg"></i>
        </button>
        <div
            class="flex-1 bg-gray-100 rounded-full h-11 px-4 flex items-center border border-transparent focus-within:bg-white focus-within:border-gray-300">
            <input id="user-input" type="text" placeholder="è¾“å…¥æŒ‡ä»¤..."
                class="bg-transparent flex-1 outline-none text-sm text-gray-800">
        </div>
        <button onclick="startChat(document.getElementById('user-input').value)"
            class="w-11 h-11 rounded-full bg-gray-900 text-white flex items-center justify-center shadow-lg active:scale-95 transition-transform">
            <i class="fa-solid fa-paper-plane"></i>
        </button>
    </div>

    <div id="crm-drawer"
        class="fixed inset-y-0 right-0 w-[85%] max-w-md bg-white shadow-2xl z-[60] drawer-right flex flex-col border-l border-gray-100">
        <div class="h-14 border-b border-gray-100 flex items-center justify-between px-4 bg-[#FFF9F5]">
            <span class="text-sm font-bold text-gray-800">å®¢æˆ·å…¨æ™¯æ¡£æ¡ˆ</span>
            <button class="w-8 h-8 rounded-full bg-white text-gray-500 flex items-center justify-center"
                onclick="toggleDrawer()">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        <div class="p-10 flex flex-col items-center justify-center h-full text-gray-400">
            <i class="fa-solid fa-address-card text-4xl mb-4 text-orange-200"></i>
            <p>è¿™é‡Œæ˜¾ç¤ºç‹å¿—è¿œçš„è¯¦ç»† Bento Grid æ¡£æ¡ˆ</p>
        </div>
    </div>
    <div id="drawer-overlay" class="fixed inset-0 bg-black/40 z-[55] hidden backdrop-blur-sm transition-opacity"
        onclick="toggleDrawer()"></div>

    <script>
        // æŒ‚è½½å®¢æˆ·ï¼ˆç©ºæ€ -> å®æ€ï¼‰
        function mountCustomer() {
            document.getElementById('customer-empty').classList.add('hidden');
            const active = document.getElementById('customer-active');
            active.classList.remove('hidden');
            active.classList.add('flex'); // ç¡®ä¿ Flex ç”Ÿæ•ˆ
        }

        // åˆ‡æ¢æŠ½å±‰
        function toggleDrawer() {
            const drawer = document.getElementById('crm-drawer');
            const overlay = document.getElementById('drawer-overlay');
            if (drawer.classList.contains('drawer-open')) {
                drawer.classList.remove('drawer-open');
                overlay.classList.add('hidden');
            } else {
                drawer.classList.add('drawer-open');
                overlay.classList.remove('hidden');
            }
        }

        // å¼€å§‹å¯¹è¯ (Curtain Lift æ ¸å¿ƒé€»è¾‘)
        function startChat(msg) {
            if (!msg) return;

            // 1. è·å–å…ƒç´ 
            const stage = document.getElementById('avatar-stage');
            const sheet = document.getElementById('chat-sheet');
            const welcomeView = document.getElementById('view-welcome');
            const chatView = document.getElementById('view-chat');
            const msgContainer = document.getElementById('msg-container');

            // 2. çŠ¶æ€æµè½¬
            stage.classList.add('minimized'); // æ•°å­—äººå˜çŸ®ï¼Œä½†ç•™å‡ºé¡¶éƒ¨ç©ºé—´
            sheet.classList.add('expanded');  // å¸·å¹•æ‹‰èµ·

            // 3. è§†å›¾åˆ‡æ¢
            welcomeView.style.opacity = '0';
            setTimeout(() => {
                welcomeView.style.display = 'none';
                chatView.classList.remove('hidden');
                chatView.classList.add('fade-enter');
            }, 300);

            // 4. æ’å…¥æ¶ˆæ¯
            document.getElementById('user-input').value = '';
            const userBubble = `
                <div class="flex flex-row-reverse items-start gap-3 fade-enter">
                    <div class="w-8 h-8 rounded-full bg-orange-100 border border-white shrink-0 overflow-hidden">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" class="w-full h-full">
                    </div>
                    <div class="bubble-user px-4 py-2.5 text-sm shadow-sm max-w-[80%]">
                        ${msg}
                    </div>
                </div>`;
            msgContainer.insertAdjacentHTML('beforeend', userBubble);

            // 5. AI å›å¤
            setTimeout(() => {
                const aiBubble = `
                    <div class="flex items-start gap-3 fade-enter">
                        <div class="w-8 h-8 rounded-full bg-blue-50 border border-white shrink-0 overflow-hidden flex items-center justify-center text-xs font-bold text-blue-600">AI</div>
                        <div class="bubble-ai px-4 py-3 text-sm shadow-sm max-w-[85%] leading-relaxed">
                            <p class="font-bold text-gray-800 mb-1">æ”¶åˆ°ï¼Œå·²æ ¹æ®ç‹æ€»çš„é¢„ç®—è¿›è¡Œè°ƒæ•´ã€‚</p>
                            é€šè¿‡ç»„åˆ<span class="text-orange-600 font-bold">æ¶ˆè´¹å‹é‡ç–¾</span>ä¸<span class="text-orange-600 font-bold">ç™¾ä¸‡åŒ»ç–—</span>ï¼Œæˆ‘ä»¬å°†æ€»ä¿è´¹æ§åˆ¶åœ¨äº† 7500å…ƒ/å¹´ï¼ŒåŒæ—¶ä¿é¢æå‡è‡³ 300ä¸‡...
                        </div>
                    </div>`;
                msgContainer.insertAdjacentHTML('beforeend', aiBubble);
            }, 800);
        }
    </script>
</body>

</html>