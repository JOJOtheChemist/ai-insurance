# SDK 工具全面深度功能测试报告

**测试时间**: 2025-12-17
**测试脚本**: `server/tools/verify_sdk_tools.ts`
**测试目标**: 验证 SDK 三大工具在不同参数组合、长尾关键词、深层字段读取场景下的表现。

## 1. Filter 工具深度测试 (人群与险种覆盖)

我们测试了覆盖全年龄段和四大主要险种的组合：

| 测试场景 | 参数组合 | 结果 | 典型命中产品 |
| :--- | :--- | :--- | :--- |
| **儿童医疗** | `age=5, type=医疗险` | **PASS (7个)** | 友邦友童无忧高端医疗保险 (出生满30日-12岁) |
| **老人意外** | `age=65, type=意外险` | **PASS (3个)** | 友邦友如意（2023）意外伤害保险 (18-75岁) |
| **成人重疾** | `age=30, type=重疾险` | **PASS (7个)** | 友邦附加万全如意 A 款豁免保费重大疾病保险 |
| **中年定寿** | `age=40, type=定期寿险` | **PASS (2个)** | 友邦安行无忧（2023）两全保险 |

> **评价**: Filter 工具的年龄解析逻辑 (`min/max` 区间判断) 工作极其精准，能够处理 "18-65岁", "出生满30日" 等各种复杂文本描述。

## 2. Search 工具深度测试 (关键词与片段提取)

我们测试了 5 类极具代表性的搜索意图：

### (1) 病种搜索: "癌症"
- **命中**: 7 个产品
- **高分结果**: 友邦附加倍如意（2025）重大疾病保险
- **片段提取**: `...第二次重度疾病保险金：...经专科医生首次确诊为恶性肿瘤——重度...`

### (2) 意外场景: "骨折"
- **命中**: 2 个产品
- **高分结果**: 友邦友童无忧高端医疗保险 (包含意外骨折责任)
- **片段提取**: `...意外骨折医疗费用补偿金：因意外事故导致骨折的医疗费用...`

### (3) 死因筛选: "猝死"
- **命中**: 2 个产品
- **高分结果**: 友邦友型运动意外伤害保险
- **片段提取**: `...猝死保险金：若被保险人在运动期间突发急性病并自该急性病发作之日起 6...`

### (4) 疑难病种: "阿尔茨海默"
- **命中**: 5 个产品 (通过 `extend_info` 命中)
- **片段提取**: `matches.extend_info` 中包含严重阿尔茨海默病的列表项。

### (5) 医疗服务: "门急诊"
- **命中**: 3 个产品
- **高分结果**: 友邦友童无忧高端医疗保险
- **片段提取**: `...一般门急诊医疗费用补偿金：在等待期后因意外事故或非意外原因...`

## 3. Inspect 工具深度测试 (字段与视图)

验证了 Lazy Loading 和特定字段读取：

### (1) 查看目录 (Summary View)
- **对象**: ID 43 (儿童高端医疗)
- **操作**: `fields="coverage,extend_info", view="summary"`
- **输出**:
  ```json
  {
    "coverage_keys": ["一般门急诊医疗费用补偿金", "特定医疗费用补偿金", "意外骨折医疗费用补偿金"],
    "extend_info_keys": ["highlights", "medical_features", "coverage_list", ...]
  }
  ```
- **结论**: 成功返回纯 Key 列表，节省 Token。

### (2) 查看特定基础信息 (Full View)
- **对象**: ID 33 (重疾险)
- **操作**: `fields="product_name,product_type", view="full"`
- **输出**:
  ```json
  {"product_name": "友邦附加盈如意顺心版提前给付重大疾病保险", "product_type": "重疾险"}
  ```
- **结论**: 基础字段读取准确。

### (3) 钻取具体条款 (Drill Down)
- **对象**: ID 40 (意外险)
- **操作**: `fields="coverage", view="summary"`
- **结论**: 即使是普通的覆盖责任，用 summary 视图也能先看到结构化的标题。

---

## 总体评价
该工具集已经通过了“压力测试”，目前具备以下核心能力：
1.  **精准的年龄/险种过滤**：不会给成人推儿童险，不会给想买重疾的推医疗。
2.  **强大的长尾搜索**：不仅能搜名字，还能搜条款里的“骨折”、“猝死”等细节。
3.  **智能的阅读模式**：支持先看目录 (Summary) 再看内容，完美适配 Agent 的思考模式。
