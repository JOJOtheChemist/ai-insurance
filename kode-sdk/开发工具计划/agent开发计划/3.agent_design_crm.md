# 保险销售辅助 Agent 设计方案 (CRM 驱动版)

**版本**: v2.0
**目标**: 打造一个专业、谨慎、数据驱动的保险销售助手，帮助销售人员准确识别客户风险，利用 SDK 工具集推荐合适产品，并通过智能 UI 引导完成销售闭环。

## 1. 核心定位 (Persona)

*   **角色**: 资深保险规划师 + 产品数据库专家
*   **性格**: 专业、客观、谨慎、有同理心
*   **原则**:
    1.  **需求为先**: 不卖“最贵”，只卖“最对”。必须先通过对话明确需求（Budget, Risk Gap）再推荐。
    2.  **条款为据**: 所有推荐理由必须基于 `inspect` 或 `search` 查到的真实条款，杜绝胡编乱造。
    3.  **风险导向**: 主动挖掘用户未意识到的风险（如：有了重疾是否缺医疗？有了意外是否缺定寿？）。

## 2. 交互逻辑架构 (The Interaction Loop)

Agent 的每一次回复不仅仅是文本，还包含**UI 引导数据**。

### 标准输出结构
```json
{
  "thought": "分析用户当前状态，决定下一步策略...",
  "message": "Agent 的自然语言回复（话术引导）...",
  "tool_calls": ["..."],
  "ui_suggestions": {
    "quick_replies": ["..."], // 用户可能点击的回答
    "follow_up_prompts": ["..."] // 下一步引导
  },
  "cards": [ // [NEW] 智能卡片（可选，按需生成）
    {
      "type": "analysis_card", // 情况分析卡片
      "title": "用户风险画像",
      "content": {
        "tags": ["30岁", "家庭支柱", "颈椎风险"],
        "risk_gap": "重疾保障缺失，目前仅有社保",
        "budget_analysis": "预算充足（1万/年），可配置高端医疗"
      }
    },
    {
      "type": "pitch_card", // 话术/推荐卡片
      "title": "针对性促单话术",
      "content": "您担心的续保问题，这款产品正好有'保证续保20年'的条款（见条款2.1），这是市面上少有的亮点...",
      "highlight_tags": ["保证续保", "无理赔优惠"]
    }
  ]
}
```

### 触发机制 (Triggers)
*   **分析卡片生成时机**: 当收集完 profile 信息（如年龄、职业、预算），进入推荐阶段前。
*   **话术卡片生成时机**: 当用户表现出犹豫（"我再想想"、"有点贵"）或提出具体异议时。

## 3. CRM 驱动架构 (CRM-Driven Architecture)

Agent 不再是“阅后即焚”的聊天机器人，而是**客户关系管理**的核心引擎。交互记录将按“客户”维度归档。

### 数据模型 (Data Model)
```json
// 客户档案 (Customer Profile)
{
  "customer_id": "cust_001",
  "basic_info": { "name": "王先生", "age": 30, "job": "程序员" },
  "sales_stage": "方案对比中", // 意向阶段
  "tags": ["理智型", "价格敏感", "已婚未育"],
  "interactions": [ // 多次对话记录
    {
      "session_id": "sess_101",
      "date": "2025-12-10",
      "agent_skill": "顾问型_初步接触", // 使用的销售技巧/Agent人设
      "summary": "用户咨询了重疾险，对价格有顾虑",
      "cards_generated": ["analysis_card_v1"]
    },
    {
      "session_id": "sess_102",
      "date": "2025-12-15",
      "agent_skill": "激进型_促单", // 换了个策略尝试
      "summary": "推荐了友邦重疾，重点攻克了续保异议",
      "cards_generated": ["pitch_card_renewal"]
    }
  ]
}
```

### 销售逻辑闭环
1.  **历史回溯**: Agent 启动时，先读取该客户的 CRM 记录，知晓之前的痛点（如“觉得贵”）和已推荐过的方案。
2.  **策略选择**: 针对“久攻不下”的客户，可以切换 `agent_skill`（如从“温和顾问”切换为“限时促销”）。
3.  **信息沉淀**: 每次对话结束，自动更新 `tags` 和 `sales_stage`，并将生成的关键卡片归档。

## 4. 交互阶段拆解 (Stages)

#### 阶段一：画像构建与风险假设 (Profiling & Hypothesis)
*   **场景**: 对话冷启动 或 CRM 中资料不全。
*   **Agent 动作**:
    1.  读取 CRM 中的 `basic_info`。
    2.  **假设风险**: 结合职业/年龄生成风险标签。
    3.  **UI 引导**: `quick_replies` 补充缺失字段（如预算）。

#### 阶段二：需求确认与工具调用 (Discovery & Tools)
*   **场景**: 用户表达了初步意向。
*   **Agent 动作**:
    1.  使用 `insurance_filter` 初筛。
    2.  使用 `insurance_search` 解决特定异议。

#### 阶段三：产品推荐与条款验证 (Recommendation & Proof)
*   **场景**: 锁定方案。
*   **Agent 动作**:
    1.  生成 **Analysis Card** 总结需求。
    2.  调用 `inspect` 生成 **Pitch Card** 进行展示。
    3.  对话结束后更新 CRM 中的 `interactions` 列表。

## 5. 工具使用策略 (Tool Strategy)

| 用户行为 | Agent 思考 | 调用工具 | 目的 |
| :--- | :--- | :--- | :--- |
| "我想给5岁孩子买保险" | 需要先圈定儿童适用的产品范围 | `insurance_filter(age_min=5, age_max=5)` | 初筛 |
| "这产品保不保白血病？" | 需要查阅具体条款或扩展信息 | `insurance_search("白血病")` 或 `inspect(id, field="extend_info")` | 确证 |
| "这个比那个好在哪？" | 需要获取两者的核心差异 | `inspect(id1, view="summary")` + `inspect(id2)` | 对比 |
| "我预算只有 2000" | 重新筛选高性价比产品 | `insurance_search("性价比")` 或 `filter(type="医疗险")` (转而推荐百万医疗) | 调整方案 |
