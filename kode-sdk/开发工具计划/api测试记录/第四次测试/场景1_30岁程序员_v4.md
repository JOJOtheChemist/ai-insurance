# 场景一：30岁程序员防猝死配置 (Fourth Test - Optimized)

**测试时间**: 2025-12-17 05:32:13
**测试环境**: 本地 API (localhost:8000)
**测试重点**: 验证 "Lazy Loading" (按需查阅) 机制能否减少 Token 消耗。

## 1. 用户输入
> "我今年30岁，是写代码的，经常熬夜。家里老婆孩子都靠我，我怕万一哪天猝死了或者得了大病，家里没钱。有没有那种性价比高的保险？最好能保猝死的。"

## 2. Agent 思考与工具调用

### Step 1: 尝试筛选 (Filter)
Agent 尝试寻找适合 30 岁的定期寿险。
**Request**: `filter(age_min=30, product_type="定期寿险")`
**Response**:
```json
{
  "products": [
    {
      "id": 20,
      "product_name": "友邦百倍安欣（精英版）定期寿险",
      "product_type": "定期寿险",
      "age_range": "男性18周岁至45周岁，女性18周岁至50周岁"
    },
    {
      "id": 31,
      "product_name": "友邦附加百倍安欣（精英版）定期寿险",
      "product_type": "定期寿险",
      "age_range": "男性18周岁至45周岁，女性18周岁至50周岁"
    }
  ]
}
```

### Step 2: 关键词搜索 "猝死"
**Request**: `search(keyword="猝死", limit=3)`
**Response**:
```json
{
  "products": [
    {
      "id": 40,
      "product_name": "友邦友型运动意外伤害保险（互联网专属）",
      "score": 80,
      "matches": {
        "description": "...包含意外事故保险金、骨折医疗、医药费用补偿及猝死保险金。...",
        "extend_info": "{\"death_payout\": \"意外身故保险金\", \"sudden_death\": \"猝死保险金\", \"disability_payout\": \"意外伤残保险金\"}"
      }
    },
    {
      "id": 7,
      "product_name": "友邦享运动意外伤害保险（互联网）",
      "score": 30,
      "matches": {
        "description": "一款包含意外身故、伤残及可选骨折医疗等责任的意外险。...",
        "extend_info": "{\"death_payout\": \"意外身故保险金\", \"sudden_death\": \"猝死保险金\", \"disability_payout\": \"意外伤残保险金\"}"
      }
    },
    {
      "id": 29,
      "product_name": "友邦附加添益（2025）意外伤害保险",
      "score": 30,
      "matches": {
        "description": "包含一般意外、航空意外等责任的意外伤害保险产品。...",
        "extend_info": "{\"death_payout\": \"一般/航空/特定/重大自然灾害\", \"sudden_death\": \"猝死保险金\", \"disability_payout\": \"一般/航空/特定/重大自然灾害\"}"
      }
    }
  ]
}
```

### Step 3: 细节查阅 (Phase 1: 概览)
Agent 决定查看 ID 40 的条款，但为了节省 Token，先看目录。
**Request**: `inspect(product_id=40, fields="product_name,coverage", view="summary")`
**Response**:
```json
{
  "product_name": "友邦友型运动意外伤害保险（互联网专属）",
  "coverage_keys": [
    "意外身故保险金",
    "意外伤残保险金",
    "意外骨折医疗保险金",
    "意外医药费用补偿金",
    "猝死保险金"
  ]
}
```
> **Agent 思考**: "我看到了 `coverage_keys` 里有 '猝死保险金'，这正是我要找的。不需要看其他几十条无关条款，只要看这一条。"

### Step 4: 细节查阅 (Phase 2: 精读)
Agent 精准提取 "猝死保险金" 的内容。
**Request**: `inspect(product_id=40, fields="coverage.猝死保险金")`
**Response**:
```json
{
  "coverage": {
    "猝死保险金": "在保险合同有效期内，若被保险人发生猝死，则本公司给付猝死保险金予身故保险金受益人。"
  }
}
```

## 3. 生成最终回复 (Simulated)
> "懂您的担心，做 IT 的确实压力大。鉴于检索结果，我为您定制了方案：
> 推荐 **友邦友型运动意外伤害保险**，它明确包含**猝死保障**（条款确认：‘在保险合同有效期内，若被保险人发生猝死，则本公司给付猝死保险金...’）。此产品对 30 岁人群非常友好..."
