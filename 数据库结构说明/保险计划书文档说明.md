# 保险计划书文档说明

## 文档定义
**保险计划书**是为特定客户定制的投保方案文档,包含客户个人信息和为其量身定制的保险产品配置。

---

## 一、数据来源

### 主表关联
1. **user**（用户表）- 客户基本信息
2. **insurance_product**（保险产品表）- 产品信息
3. **member_subscription**（会员订阅表）- 订阅关系（可选）
4. **order**（订单表）- 订单信息（如已下单）

---

## 二、文档应包含的内容

### 第一部分：客户信息（来自 user 表）

| 字段 | 数据库字段 | 必填 | 说明 |
|------|-----------|------|------|
| 客户姓名 | real_name | ✅ | 投保人真实姓名 |
| 身份证号 | id_card | ✅ | 身份证号码(需脱敏显示) |
| 手机号码 | phone_number | ✅ | 联系电话(需脱敏显示) |
| 昵称 | nickname | ⭕ | 用户昵称 |
| 会员等级 | member_level | ⭕ | 0-普通 1-月度 2-季度 3-年度 |
| 会员到期时间 | member_expire_time | ⭕ | VIP到期日期 |

**脱敏规则示例**：
- 姓名：`张**`（保留姓氏）
- 身份证：`320123********1234`（保留前6位和后4位)
- 手机号：`138****5678`（保留前3位和后4位）

---

### 第二部分：产品信息（来自 insurance_product 表）

#### 1. 基础信息
| 字段 | 数据库字段 | 必填 | 说明 |
|------|-----------|------|------|
| 产品名称 | product_name | ✅ | 完整产品名称 |
| 产品代码 | product_code | ✅ | 产品编号 |
| 产品类型 | product_type | ✅ | 险种类型 |
| 保险公司 | company_name | ✅ | 承保公司 |
| 产品图片 | image_url | ⭕ | 产品LOGO |

#### 2. 投保方案配置
| 字段 | 来源 | 必填 | 说明 |
|------|------|------|------|
| **投保保额** | 自定义输入 | ✅ | 客户选择的保额(范围在min_amount~max_amount之间) |
| **年交保费** | 自定义输入 | ✅ | 客户实际支付的保费 |
| **交费期间** | 客户选择 | ✅ | 如:10年交、20年交 |
| **保险期间** | 客户选择 | ✅ | 如:终身、至70周岁 |
| **投保日期** | 自定义输入 | ✅ | 计划书生成日期或预计投保日期 |
| 生效日期 | 自动计算 | ⭕ | 投保日期 + 等待期 |

#### 3. 保障详情
| 字段 | 数据库字段 | 必填 | 说明 |
|------|-----------|------|------|
| 保障范围 | coverage | ✅ | 详细保障项目 |
| 产品详情 | details | ⭕ | 完整产品介绍 |
| 投保年龄 | age_range | ✅ | 年龄限制 |
| 等待期 | waiting_period | ✅ | 等待期说明 |
| 犹豫期 | cooling_off_period | ✅ | 犹豫期天数 |

#### 4. 责任说明
| 字段 | 数据库字段 | 必填 | 说明 |
|------|-----------|------|------|
| 责任免除 | exclusions | ✅ | 免责条款 |
| 退保说明 | surrender_terms | ⭕ | 退保规则 |

---

### 第三部分：订单信息（可选,来自 order 表）

| 字段 | 数据库字段 | 必填 | 说明 |
|------|-----------|------|------|
| 订单编号 | order_no | ⭕ | 如已下单则显示 |
| 订单金额 | amount | ⭕ | 订单总金额 |
| 支付金额 | pay_amount | ⭕ | 实际支付金额 |
| 支付状态 | pay_status | ⭕ | 0-未支付 1-已支付 |
| 支付时间 | pay_time | ⭕ | 支付完成时间 |
| 订单创建时间 | create_time | ⭕ | 订单生成时间 |

---

### 第四部分：利益演示（需自行计算）

**注意**：数据库中没有存储,需要根据产品规则计算

| 项目 | 说明 |
|------|------|
| 累计保费 | 年交保费 × 交费年限 |
| 现金价值表 | 按保单年度列表展示 |
| 满期金/生存金 | 如为两全险/年金险 |
| 红利演示 | 如为分红险(低/中/高档) |

**示例**：
```
保单年度    已交保费    现金价值    累计红利(中档)
第1年      10,000     1,500       200
第2年      20,000     12,800      850
...
第20年     200,000    280,000     45,000
```

---

## 三、文档结构建议

```
【保险计划书】

━━━━━━━━━━━━━━━━━━━━━━
          尊敬的 张**女士/先生
━━━━━━━━━━━━━━━━━━━━━━

📋 一、客户信息
  姓名：张**
  身份证号：320123********1234
  联系电话：138****5678
  会员等级：年度VIP会员
  计划书生成日期：2025-12-12

━━━━━━━━━━━━━━━━━━━━━━

📦 二、产品方案
  产品名称：友邦XX终身寿险
  产品代码：AIA-XXX-001
  保险公司：友邦人寿保险有限公司
  产品类型：终身寿险

━━━━━━━━━━━━━━━━━━━━━━

💰 三、投保方案
  投保保额：500,000 元
  年交保费：15,800 元
  交费期间：20 年交
  保险期间：终身
  投保年龄：30 周岁
  保单生效日：2025-12-27（投保后15天）
  等待期：90 天
  犹豫期：20 天

━━━━━━━━━━━━━━━━━━━━━━

🛡️ 四、保障内容
  [保障范围详细内容]
  [产品详情详细内容]

━━━━━━━━━━━━━━━━━━━━━━

📊 五、利益演示
  累计保费：316,000 元（15,800 × 20年）
  
  【现金价值表】
  保单年度    已交保费    现金价值
  第1年      15,800     2,500
  第5年      79,000     68,000
  第10年     158,000    145,000
  第20年     316,000    380,000
  第30年     316,000    520,000

━━━━━━━━━━━━━━━━━━━━━━

⚠️ 六、重要声明
  【责任免除】
  [免责条款内容]
  
  【退保说明】
  [退保规则内容]

━━━━━━━━━━━━━━━━━━━━━━

✅ 七、订单信息（如已下单）
  订单编号：20251212001234567
  订单金额：15,800.00 元
  支付状态：已支付
  支付时间：2025-12-12 10:30:25

━━━━━━━━━━━━━━━━━━━━━━

本计划书仅供参考,最终以保险合同为准。
保险代理人：XXX
联系电话：138XXXX5678
生成时间：2025-12-12 10:45:30
```

---

## 四、计划书与产品详情的区别

| 维度 | 产品详情 | 保险计划书 |
|------|---------|-----------|
| **定位** | 通用产品介绍 | 个性化投保方案 |
| **客户信息** | ❌ 无 | ✅ 有（姓名、身份证、手机） |
| **保额/保费** | 范围区间(最低~最高) | 具体数值(客户选择的) |
| **投保日期** | ❌ 无 | ✅ 有（具体日期） |
| **利益演示** | ❌ 无 | ✅ 有（现金价值表） |
| **订单关联** | ❌ 无 | ✅ 可关联订单 |
| **使用场景** | 产品宣传、咨询 | 投保决策、签约 |
| **数据来源** | 仅 insurance_product | user + insurance_product + order |

---

## 五、数据查询示例

```sql
-- 查询计划书所需的完整数据
SELECT 
    -- 客户信息
    u.real_name,
    u.id_card,
    u.phone_number,
    u.nickname,
    u.member_level,
    u.member_expire_time,
    
    -- 产品信息
    p.product_name,
    p.product_code,
    p.product_type,
    p.company_name,
    p.min_amount,
    p.max_amount,
    p.min_premium,
    p.max_premium,
    p.coverage,
    p.details,
    p.image_url,
    p.age_range,
    p.insurance_period,
    p.payment_period,
    p.waiting_period,
    p.cooling_off_period,
    p.exclusions,
    p.surrender_terms,
    
    -- 订单信息（可选）
    o.order_no,
    o.amount,
    o.pay_amount,
    o.pay_status,
    o.pay_time,
    o.create_time
    
FROM user u
CROSS JOIN insurance_product p  -- 客户选择的产品
LEFT JOIN `order` o ON o.user_id = u.id AND o.package_id = p.id  -- 如有订单
WHERE u.id = ? AND p.id = ? AND p.status = 1;
```

---

## 六、安全注意事项

### 🔒 隐私保护
1. **必须脱敏显示**：姓名、身份证号、手机号
2. **访问权限控制**：仅客户本人和授权代理人可查看
3. **数据传输加密**：HTTPS + 敏感字段加密存储
4. **日志记录**：记录计划书的生成和查看日志

### 📋 合规要求
1. 计划书需包含**保险条款链接**或**重要提示**
2. 利益演示需标注**非保证收益**（如为分红险）
3. 免责条款需**醒目显示**
4. 需客户**电子签名确认**后方可生效

---

## 七、使用场景

1. **投保咨询**：为客户生成个性化方案
2. **方案对比**：为同一客户生成多个产品方案对比
3. **投保确认**：客户确认方案后生成正式计划书
4. **订单凭证**：下单后作为投保凭证
5. **会员服务**：VIP会员的专属保障方案

---

## 八、扩展字段建议

**建议新增表**：`insurance_plan`（保险计划书表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 计划书ID |
| user_id | bigint | 客户ID |
| product_id | bigint | 产品ID |
| plan_no | varchar(64) | 计划书编号 |
| insured_amount | decimal(15,2) | 投保保额 |
| annual_premium | decimal(15,2) | 年交保费 |
| payment_period | varchar(50) | 交费期间 |
| insurance_period | varchar(50) | 保险期间 |
| plan_date | date | 计划书日期 |
| status | tinyint | 状态:0-草稿 1-已确认 2-已下单 |
| order_id | bigint | 关联订单ID（可选） |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

---

*文档创建时间：2025-12-12*
